

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AtlasDB Sweep Endpoints &mdash; OSS AtlasDB develop documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=7ab3649f" />
      <link rel="stylesheet" type="text/css" href="../../../_static/release-notes.css?v=b943762f" />
      <link rel="stylesheet" type="text/css" href="../../../_static/theme_overrides.css?v=fd4cc2db" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=4191f987"></script>
      <script src="../../../_static/doctools.js?v=888ff710"></script>
      <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="AtlasDB Sweep CLI" href="sweep-cli.html" />
    <link rel="prev" title="Background Sweep" href="background-sweep.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            OSS AtlasDB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../schemas/index.html">Schemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../transactions/index.html">Transactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/index.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Cluster Management</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../clis.html">Command Line Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../console.html">Console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kvs-migration.html">KVS Migration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../sweep.html">AtlasDB Sweep</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../freeing-space.html">Freeing space after sweep</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../standard-sweep.html">Standard Sweep</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="background-sweep.html">Background Sweep</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">AtlasDB Sweep Endpoints</a></li>
<li class="toctree-l4"><a class="reference internal" href="sweep-cli.html">AtlasDB Sweep CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="sweep-logs.html">Background Sweep Inner Workings and Logs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../targeted-sweep.html">Targeted Sweep</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../performance/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../miscellaneous/index.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/index.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes/index.html">Releases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">OSS AtlasDB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Cluster Management</a></li>
          <li class="breadcrumb-item"><a href="../../sweep.html">AtlasDB Sweep</a></li>
          <li class="breadcrumb-item"><a href="../standard-sweep.html">Standard Sweep</a></li>
      <li class="breadcrumb-item active">AtlasDB Sweep Endpoints</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/palantir/atlasdb/blob/develop/docs/source/cluster_management/sweep/standard/sweep-endpoints.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="atlasdb-sweep-endpoints">
<span id="id1"></span><h1>AtlasDB Sweep Endpoints<a class="headerlink" href="#atlasdb-sweep-endpoints" title="Permalink to this heading"></a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Sweeps can be resource-intensive (especially if batching parameters are generous and/or cells have very large
values). The sweep endpoints don’t currently support cancellation, so to stop a running sweep you will need to
bounce your service. This is likely to be acceptable if your service is deployed in an HA configuration, but be
careful when using the sweep endpoint in non-HA configurations.</p>
</div>
<p>If you ever need to force a particular table to be swept immediately, you can run sweep by making a POST request to the
<code class="docutils literal notranslate"><span class="pre">/sweep/sweep-table</span></code> endpoint. Sweep runs initiated via the endpoint are configurable via standard HTTP query
parameters.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 50.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Required/Optional</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tablename</span></code></p></td>
<td><p>Fully qualified name of table to be swept (inclusive of namespace; e.g. <code class="docutils literal notranslate"><span class="pre">namespace.actualTableName</span></code>).</p></td>
<td><p>Required</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">startRow</span></code></p></td>
<td><p>Base16 encoded row where Sweep will start sweeping from.</p></td>
<td><p>Optional (default: empty - i.e. first row of table)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fullSweep</span></code></p></td>
<td><p>Whether to sweep a full table. If set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, we will sweep just one batch.</p></td>
<td><p>Optional (default: true)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">maxCellTsPairsToExamine</span></code></p></td>
<td><p>Total number of cell-timestamp pairs to examine before a batch completes. Note that Sweep may actually read more
than this value if that is required to complete reading all cell-timestamp pairs in a given row.</p></td>
<td><p>Optional (default: 128)*</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">candidateBatchSize</span></code></p></td>
<td><p>Number of cell-timestamp pairs to query the key value service for at a time.</p></td>
<td><p>Optional (default: 128)*</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">deleteBatchSize</span></code></p></td>
<td><p>Number of cell-timestamp pairs to delete from the key-value service at a time. Note that Sweep may attempt
slightly larger deletes than this value, but it is guaranteed that it does not exceed twice this.</p></td>
<td><p>Optional (default: 128)*</p></td>
</tr>
</tbody>
</table>
<p>* Note the the sweep config might be lower if previous sweep runs have failed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If using curl from a shell to hit the sweep endpoint, please remember to escape ampersands and/or quote the
URL provided to curl; otherwise, the ampersand will end the command and run curl in the background with the first
parameter provided, disregarding all other parameters.</p>
<p>A correct query could look like this. If the URL was not quoted, this would sweep the table from the beginning.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -k -XPOST &#39;https://palantir:9999/sweep/sweep-table?tablename=foo.bar&amp;startRow=3141592654&#39;
</pre></div>
</div>
</div>
<p>Using the sweep endpoints to manually kick off sweep will <em>not</em> update the Background Sweeper’s sweep priority table.
This will publish some metrics (such as the number of cell-timestamp pairs examined and deleted), but not all
(in particular, sweep outcome metrics are not published).</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="background-sweep.html" class="btn btn-neutral float-left" title="Background Sweep" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sweep-cli.html" class="btn btn-neutral float-right" title="AtlasDB Sweep CLI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Palantir Technologies.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>