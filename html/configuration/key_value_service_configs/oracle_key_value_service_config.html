<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DB KVS (Oracle - beta) Configuration &mdash; OSS AtlasDB develop documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/release-notes.css?v=b943762f" />
      <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css?v=fd4cc2db" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=4191f987"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="External Timelock Service Configurations" href="../external_timelock_service_configs/index.html" />
    <link rel="prev" title="DB KVS (Postgres) Configuration" href="postgres_key_value_service_config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            OSS AtlasDB
          </a>
              <div class="version">
                develop
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../schemas/index.html">Schemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../transactions/index.html">Transactions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Key Value Service Configurations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cassandra_key_value_service_config.html">Cassandra KVS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_key_value_services_config.html">DB KVS Shared Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgres_key_value_service_config.html">DB KVS (Postgres) Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">DB KVS (Oracle - beta) Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../external_timelock_service_configs/index.html">External Timelock Service Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cassandra_config.html">Cassandra Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multinode_cassandra.html">Multinode Cassandra HA Guarantees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enabling_cassandra_tracing.html">Enabling Cassandra Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leader_config.html">Leader Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Logging Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timestamp_client.html">Timestamp Client Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal_schemas.html">Internal Schema Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cluster_management/index.html">Cluster Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../performance/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/index.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes/index.html">Releases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OSS AtlasDB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Configuration</a></li>
          <li class="breadcrumb-item"><a href="index.html">Key Value Service Configurations</a></li>
      <li class="breadcrumb-item active">DB KVS (Oracle - beta) Configuration</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/palantir/atlasdb/blob/develop/docs/source/configuration/key_value_service_configs/oracle_key_value_service_config.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="db-kvs-oracle-beta-configuration">
<span id="oracle-configuration"></span><h1>DB KVS (Oracle - beta) Configuration<a class="headerlink" href="#db-kvs-oracle-beta-configuration" title="Permalink to this heading"></a></h1>
<section id="enabling-oracle-for-your-application">
<h2>Enabling Oracle for your Application<a class="headerlink" href="#enabling-oracle-for-your-application" title="Permalink to this heading"></a></h2>
<p>To enable your application to be backed by Oracle, you just need to add AtlasDB DbKvs and the OracleJDBC driver as a
runtime dependency. In gradle this looks like:</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">runtime</span><span class="w"> </span><span class="s1">&#39;com.palantir.atlasdb:atlasdb-dbkvs:&lt;atlas version&gt;&#39;</span>
<span class="n">runtime</span><span class="w"> </span><span class="s1">&#39;com.palantir.atlasdb:dbkvs-oracle-driver:&lt;oracle driver version&gt;&#39;</span>
</pre></div>
</div>
<p>e.g.</p>
<div class="highlight-groovy notranslate"><div class="highlight"><pre><span></span><span class="n">runtime</span><span class="w"> </span><span class="s1">&#39;com.palantir.atlasdb:atlasdb-dbkvs:0.1014.0&#39;</span>
<span class="n">runtime</span><span class="w"> </span><span class="s1">&#39;com.palantir.atlasdb:dbkvs-oracle-driver:0.3.0&#39;</span>
</pre></div>
</div>
</section>
<section id="configuring-a-running-application-to-use-oracle">
<h2>Configuring a Running Application to Use Oracle<a class="headerlink" href="#configuring-a-running-application-to-use-oracle" title="Permalink to this heading"></a></h2>
<p>A minimal AtlasDB configuration for running against Oracle will look like the below.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">atlasdb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">keyValueService</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">relational</span>
<span class="w">    </span><span class="nt">ddl</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">oracle</span>
<span class="w">      </span><span class="nt">overflowMigrationState</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FINISHED</span>
<span class="w">      </span><span class="nt">jdbcHandler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">oracle</span>
<span class="w">    </span><span class="nt">connection</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">oracle</span>
<span class="w">      </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">oracle</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1521</span>
<span class="w">      </span><span class="nt">sid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">palantir</span>
<span class="w">      </span><span class="nt">dbLogin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">palantir</span>
<span class="w">      </span><span class="nt">dbPassword</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7_SeeingStones_7</span>
<span class="w">    </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myAppAtlas</span><span class="w"> </span><span class="c1"># must be unique per product</span>

<span class="w">  </span><span class="nt">leader</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># This should be at least half the number of nodes in your cluster</span>
<span class="w">    </span><span class="nt">quorumSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">    </span><span class="nt">learnerLogDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var/data/paxosLogs</span>
<span class="w">    </span><span class="nt">acceptorLogDir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var/data/paxosLogs</span>
<span class="w">    </span><span class="c1"># This should be different for every node. If ssl is not enabled, then the host must be specified as http</span>
<span class="w">    </span><span class="nt">localServer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://&lt;yourhost&gt;:3828</span>
<span class="w">    </span><span class="c1"># This should be the same for every node. If ssl is not enabled, then the host must be specified as http</span>
<span class="w">    </span><span class="nt">lockCreator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://host1:3828</span>
<span class="w">    </span><span class="c1"># This should be the same for every node</span>
<span class="w">    </span><span class="nt">leaders</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://host1:3828</span><span class="w"> </span><span class="c1"># If ssl is not enabled, then the hosts must be specified as http</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://host2:3828</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://host3:3828</span>
</pre></div>
</div>
<p>For more details on the leader block, see <a class="reference internal" href="../leader_config.html#leader-config"><span class="std std-ref">Leader Configuration</span></a>.</p>
</section>
<section id="configuration-parameters">
<span id="oracle-config-params"></span><h2>Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Permalink to this heading"></a></h2>
<p>The Oracle Configuration has 2 major blocks.</p>
<section id="ddl-parameters">
<h3>DDL parameters<a class="headerlink" href="#ddl-parameters" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.3%" />
<col style="width: 66.7%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>overflowMigrationState</p></td>
<td><p>The value should be 3(FINISHED) for all new clients.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>tableFactorySupplier</p></td>
<td><p>This should supply the <code class="docutils literal notranslate"><span class="pre">DbTableFactory</span></code> required for setting up database operations.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>metadataTable</p></td>
<td><p>The metadataTable should be a tableReference to the metadata table. The default value is
{namespace:””, tablename:”_metadata”}.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>tablePrefix</p></td>
<td><p>The value should be a string with only alpha numeric characters or underscores. This should not begin
with an underscore. Default value is “a_”.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>poolSize</p></td>
<td><p>The number of threads in the connection pool to Oracle, defaults to 64.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>fetchBatchSize</p></td>
<td><p>The number of cells fetched in batch queries like <code class="docutils literal notranslate"><span class="pre">getAllRows</span></code>, <code class="docutils literal notranslate"><span class="pre">getAllTimestamps</span></code> etc., defaults to 256.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>mutationBatchCount</p></td>
<td><p>The maximum number of cells in a batch for write operations like <code class="docutils literal notranslate"><span class="pre">put</span></code>, <code class="docutils literal notranslate"><span class="pre">putWithTimestamps</span></code>,
defaults to 1000.</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>mutationBatchSizeBytes</p></td>
<td><p>The maximum bytes in a batch for write operations like <code class="docutils literal notranslate"><span class="pre">put</span></code>, <code class="docutils literal notranslate"><span class="pre">putWithTimestamps</span></code>, defaults to 2MB.</p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
</section>
<section id="connection-parameters">
<h3>Connection parameters<a class="headerlink" href="#connection-parameters" title="Permalink to this heading"></a></h3>
<p>If you would like to customize the JDBC connection parameters, for example if you are experiencing performance issues, then you may supply them under the <code class="docutils literal notranslate"><span class="pre">connection</span></code> section of the <code class="docutils literal notranslate"><span class="pre">keyValueService</span></code> config.
An example is shown below; for full documentation on which parameters are available, check out <a class="reference external" href="https://jdbc.postgresql.org/documentation/head/connect.html">the JDBC docs</a>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">atlasdb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">keyValueService</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># as above - skipped for brevity</span>
<span class="w">    </span><span class="nt">connection</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># as above - skipped for brevity</span>
<span class="w">      </span><span class="nt">connectionParameters</span><span class="p">:</span><span class="w"> </span><span class="c1"># JDBC connection parameters</span>
<span class="w">        </span><span class="nt">defaultRowFetchSize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w"> </span><span class="c1"># Default: unlimited. Adjusts the number of rows fetched in each database request.</span>
</pre></div>
</div>
<p>These are the required parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.3%" />
<col style="width: 66.7%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Required</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>host</p></td>
<td><p>The host running Oracle.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>port</p></td>
<td><p>The port exposed by the Oracle server for Oracle client connections.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>sid</p></td>
<td><p>The site identifier for the Oracle server.</p></td>
<td><p>No, but one of sid and serviceNameConfiguration must be specified.</p></td>
</tr>
<tr class="row-odd"><td><p>serviceNameConfiguration.serviceName</p></td>
<td><p>The service name for the Oracle server.</p></td>
<td><p>No, but one of sid and serviceNameConfiguration must be specified.</p></td>
</tr>
<tr class="row-even"><td><p>serviceNameConfiguration.namespaceOverride</p></td>
<td><p>The namespace for this Oracle key-value service. If you are migrating from a database with a given sid,
this value should be set to the value of that sid before the migration. If you are bootstrapping a new
stack, this value should be set to the value of the top-level AtlasDB namespace config if present; otherwise,
it may be set arbitrarily (but <em>must</em> be set to some value).</p></td>
<td><p>No, but one of sid and serviceNameConfiguration must be specified.</p></td>
</tr>
<tr class="row-odd"><td><p>dbLogin</p></td>
<td><p>The Oracle DB username.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>dbPassword</p></td>
<td><p>The Oracle DB password.</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
</section>
<section id="migrating-connection-methods">
<h3>Migrating Connection Methods<a class="headerlink" href="#migrating-connection-methods" title="Permalink to this heading"></a></h3>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Improperly migrating from one method of connecting to Oracle to another can result in <strong>SEVERE DATA CORRUPTION</strong>!
Please contact the AtlasDB team before attempting such a migration.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The processes outlined below <strong>ONLY</strong> apply for Oracle users using embedded timestamp and lock services.
TimeLock users should contact the AtlasDB team before attempting such a migration. The procedures outlined below
employed naively can result in <strong>SEVERE DATA CORRUPTION</strong>!</p>
</div>
<p>AtlasDB supports connecting to an Oracle database via its <cite>sid</cite>, or through a <cite>serviceName</cite> (the latter is configured
through a <cite>serviceNameConfiguration</cite>).</p>
<p>When migrating from using <cite>sid</cite> to <cite>serviceName</cite>, the user must specify the original value of the <cite>sid</cite> before the
migration as <cite>serviceNameConfiguration.namespaceOverride</cite>.</p>
<p>This migration can be reversed trivially (just by changing the config to reference the now-correct <cite>sid</cite>) if you are
using embedded timestamp and lock services.</p>
<section id="fixing-tables-that-have-a-missing-overflow-column">
<h4>Fixing tables that have a missing overflow column<a class="headerlink" href="#fixing-tables-that-have-a-missing-overflow-column" title="Permalink to this heading"></a></h4>
<p>This error may manifest itself as an <cite>ORA-00904: “OVERFLOW”`</cite>, or <cite>“invalid identifier: OVERFLOW”</cite></p>
<p>On rare occasions, the metadata in Oracle can mismatch the expected
metadata by the service. This can happen as a result of a rare race
condition on table creation, where one service expects the table to have
an overflow column, while the other does not.</p>
<p>To resolve, simply add the following configuration to your Oracle ddl
configuration.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">atlasdb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">keyValueService</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">relational</span>
<span class="w">    </span><span class="nt">ddl</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">oracle</span>
<span class="w">      </span><span class="nt">alterTablesOrMetadataToMatchAndIKnowWhatIAmDoing</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">physicalTableName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;physicalTableName&gt;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To determine your <code class="docutils literal notranslate"><span class="pre">physicalTableName</span></code> given an <code class="docutils literal notranslate"><span class="pre">ORA-00904</span></code>
stacktrace, you should see a table name with a similar form to <code class="docutils literal notranslate"><span class="pre">x_yz__tablename_1234</span></code> within the
full SQL string that was ran. The full string <code class="docutils literal notranslate"><span class="pre">x_yz__tablename_1234</span></code> is your <code class="docutils literal notranslate"><span class="pre">physicalTableName</span></code>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you already know the logical table name and table namespace that’s
affected (e.g, using your AtlasDB schema file), then you can use the
following configuration instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">atlasdb</span><span class="p">:</span>
 <span class="n">keyValueService</span><span class="p">:</span>
   <span class="nb">type</span><span class="p">:</span> <span class="n">relational</span>
   <span class="n">ddl</span><span class="p">:</span>
     <span class="nb">type</span><span class="p">:</span> <span class="n">oracle</span>
     <span class="n">alterTablesOrMetadataToMatchAndIKnowWhatIAmDoing</span><span class="p">:</span>
         <span class="o">-</span> <span class="n">namespace</span><span class="p">:</span>
             <span class="n">name</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">namespace</span><span class="o">&gt;</span>
             <span class="n">tablename</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">table</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<p>Generally speaking the operation is safe to perform, although it’s on the operator to determine what the side
effects are. For example, if the issue arose as two services are configured to use this table, but only
one is performing table mapping, then it is expected that this could break one of the services. However,
that condition still satisfies the status quo, thus it’s on the configurator to determine if this change is
safe to make.</p>
<p>Although the alter action is idempotent, it is recommended to remove the configuration after it has ran. Check the logs
for the presence of a log line <code class="docutils literal notranslate"><span class="pre">Altering</span> <span class="pre">table</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">overflow</span> <span class="pre">column</span> <span class="pre">to</span> <span class="pre">match</span> <span class="pre">metadata.</span></code>, and verify there is no
error log line of the form <code class="docutils literal notranslate"><span class="pre">Error</span> <span class="pre">occurred</span> <span class="pre">trying</span> <span class="pre">to</span> <span class="pre">execute</span> <span class="pre">the</span> <span class="pre">Oracle</span> <span class="pre">query</span></code> immediately following it. If there is,
then the alter action failed. Please determine if the stacktrace in the error log line relates to an operator error,
or requires further assistance from Palantir support.</p>
<p>If, upon adding the above config, you continue to see the same error, then please follow the steps below:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Check for log lines starting with <code class="docutils literal notranslate"><span class="pre">Potentially</span> <span class="pre">altering</span> <span class="pre">table</span></code>:</dt><dd><ul class="simple">
<li><p>Verify that your table reference / physical table name shows up in one of the log lines.</p></li>
<li><p>Note that physical table names are logged unsafely, if your infrastructure understands log safety.</p></li>
<li><p>If this is not present, then your service is not re-issuing a call to <code class="docutils literal notranslate"><span class="pre">KeyValueService#createTable</span></code>.</p></li>
<li><p>To fix, attempt to recreate the table using <code class="docutils literal notranslate"><span class="pre">KeyValueService#createTable</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Check for log lines containing <code class="docutils literal notranslate"><span class="pre">Overflow</span> <span class="pre">table</span> <span class="pre">migrated</span> <span class="pre">status:</span></code> containing your table reference / physical table name.</dt><dd><ul class="simple">
<li><p>Verify that <code class="docutils literal notranslate"><span class="pre">overflowTableHasMigrated</span></code> and <code class="docutils literal notranslate"><span class="pre">overflowTableExists</span></code> are both true, and <code class="docutils literal notranslate"><span class="pre">overflowColumnExists</span></code> is false.</p></li>
<li><p>If any of these are incorrect, then it is likely your issue does not pertain to a missing overflow column. Please contact support for further assistance.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Check for the log line containing the stack trace with exception message <code class="docutils literal notranslate"><span class="pre">Unable</span> <span class="pre">to</span> <span class="pre">alter</span> <span class="pre">table</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">overflow</span> <span class="pre">column</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">table</span> <span class="pre">mapping</span> <span class="pre">error.</span></code>.</dt><dd><ul class="simple">
<li><p>Note that this exception message is marked unsafe. You may alternatively be able to find this stacktrace with the cause of type <code class="docutils literal notranslate"><span class="pre">TableMappingNotFoundException</span></code>.</p></li>
<li><p>If this is present, please determine if the exception cause relates to an operator error, or requires further assistance from Palantir support.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="postgres_key_value_service_config.html" class="btn btn-neutral float-left" title="DB KVS (Postgres) Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../external_timelock_service_configs/index.html" class="btn btn-neutral float-right" title="External Timelock Service Configurations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Palantir Technologies.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>